!function(e){e.__env=e.__env||{},e.__env.apiUrl="http://localhost:8003",e.__env.baseUrl="/",e.__env.supportEmail="jknight@lunenfeld.ca",e.__env.supportName="James Knight",e.__env.clientID="498894175021-2v85kl2dnmnsqsaqo94a5ls6gsjbj7u4"}(this),function(){"use strict";angular.module("app",["ct.ui.router.extras","ngAnimate","ngMaterial","ngMessages","ngSanitize","PPVN","ui.router"])}(),function(){"use strict";angular.module("app").config(["$mdThemingProvider",function(e){e.theme("default").primaryPalette("blue-grey").accentPalette("orange").foregroundPalette[3]="#455a64"}]).constant("__env",window.__env)}(),function(){"use strict";angular.module("app").run(["$state","$rootScope",function(e,t){t.$state=e}]).config(["$locationProvider","$stateProvider","$urlRouterProvider",function(e,t,n){n.otherwise("/404"),t.state("root",{url:"/",sticky:!0,dsr:!0,views:{admin:{templateUrl:"app/admin/admin.html"},close:{templateUrl:"app/404/close.html"},error:{templateUrl:"app/404/404.html"},home:{templateUrl:"app/home/home.html"},profile:{templateUrl:"app/profile/profile.html"},treasure:{templateUrl:"app/404/treasure.html"}}}).state("root.admin",{url:"admin"}).state("root.close",{url:"treasure"}).state("root.error",{url:"404"}).state("root.home",{url:""}).state("root.profile",{url:"profile"}).state("root.treasure",{url:"0111010001110010011001010110000101110011011101010111001001100101"}),e.html5Mode(!0)}])}(),function(){"use strict";angular.module("app").directive("collapse",[function(){return{restrict:"A",link:function(e,t,n){var o=n.collapse,i=t[0].closest("."+o),r=i.querySelector(".collapse-container"),s=i.querySelector(".collapse-header");r.style.transition="all 500ms",r.style.webkitTransition="all 500ms",s.style.transition="all 500ms",s.style.webkitTransition="all 500ms",t.bind("click",function(e){var n=i.querySelector(".collapse-icons-other"),a=i.querySelector('[expand="'+o+'"]');n.style.display="none",r.style.display="none",s.style.display="block",t[0].style.display="none",a.style.display="inline"})}}}]).directive("expand",[function(){return{restrict:"A",link:function(e,t,n){var o=n.expand,i=t[0].closest("."+o);t[0].style.display="none",t.bind("click",function(e){var n=i.querySelector(".collapse-icons-other"),r=i.querySelector('[collapse="'+o+'"]'),s=i.querySelector(".collapse-container"),a=i.querySelector(".collapse-header");n.style.display="inline",r.style.display="inline",s.style.display="inline",a.style.display="none",t[0].style.display="none"})}}}])}(),function(){"use strict";angular.module("app").directive("flipMenu",[function(){return{restrict:"A",link:function(e,t,n){var o=n.flipMenu,i=document.getElementById(o),r=n.flipMenuHeight,s=n.flipMenuWidth;i&&(i.style.maxHeight="0px",i.style.minWidth="0px",i.style.overflow="hidden",i.style.transformOrigin="left center",i.style.transform="rotateY(90deg)",i.style.visibility="hidden",i.style.webkitTransform="rotateY(90deg)",i.style.width="0px",t.bind("click",function(){"rotateY(90deg)"===i.style.webkitTransform?(i.style.transition="all 500ms",i.style.maxHeight=r,i.style.minWidth=s,i.style.transform="rotateY(0deg)",i.style.visibility="visible",i.style.webkitTransform="rotateY(0deg)",i.style.width="auto"):(i.style.maxHeight="0px",i.style.minWidth="0px",i.style.transform="rotateY(90deg)",i.style.visibility="hidden",i.style.webkitTransform="rotateY(90deg)",i.style.width="0px")}))}}}])}(),function(){"use strict";angular.module("app").directive("mdTooltipDestroy",[function(){return{restrict:"A",link:function(e,t,n){t.bind("click",function(e){var t=document.getElementsByTagName("md-tooltip")[0];t&&t.remove()})}}}])}(),function(){"use strict";angular.module("app").service("credentials",["$rootScope",function(e){var t={};this.get=function(){return t},this.set=function(n){t=n,e.$broadcast("credentials:updated",t)}}])}(),function(){"use strict";angular.module("app").directive("compile",["$compile",function(e){return function(t,n,o){var i=t.$watch(function(e){return e.$eval(o.compile)},function(o){n.html(o),e(n.contents())(t),i()})}}])}(),function(){"use strict";angular.module("app").service("helperDialog",["$mdDialog",function(e){this.alert=function(t,n){e.show({clickOutsideToClose:!0,controller:"alert",controllerAs:"vm",locals:{message:n,title:t},parent:angular.element(document.body),templateUrl:"app/dialogs/alert/alert.html"})}}])}(),function(){"use strict";angular.module("app").service("helperHTTP",["credentials","__env","helperDialog","$http",function(e,t,n,o){this.set=function(i,r,s,a){var c=e.get();o({method:"POST",url:t.apiUrl+"/"+i,headers:{"Content-Type":"application/json",user:JSON.stringify(c)},data:r}).then(function(e){e.data.status?a(e):s(e)},function(){n.alert("Connection error","The server could not be reached.")})},this.get=function(i,r,s,a){var c=e.get(),l="?";for(var u in r)l+=u+"="+r[u]+"&";o({method:"GET",url:t.apiUrl+"/"+i+"/"+l,headers:{"Content-Type":"application/json",user:JSON.stringify(c)}}).then(function(e){e.data.status?a(e):s(e)},function(){n.alert("Connection error","The server could not be reached.")})}}])}(),function(){"use strict";angular.module("app").service("helperObject",[function(){this.notEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!0;return!1}}])}(),function(){"use strict";angular.module("app").service("helperReport",["__env","$window",function(e,t){this.mail=function(n){t.location.href="mailto:"+e.supportEmail+"?subject="+n}}])}(),function(){"use strict";angular.module("app").controller("alert",["__env","helperReport","$mdDialog","$scope","message","title",function(e,t,n,o,i,r){var s=this;s.close=function(){n.hide()},s.message=i,s.reportError=function(e){t.mail(e)},s.supportName=e.supportName,s.title=r}])}(),function(){"use strict";angular.module("app").controller("404",["__env","helperReport","$scope","$window",function(e,t,n,o){var i=this;i.supportName=e.supportName,i.reportError=function(e){t.mail(e)}}])}(),function(){"use strict";angular.module("app").service("projects",["$rootScope",function(e){var t=[];this.add=function(n){t.push(n),e.$broadcast("projects:updated",t)},this.get=function(){return t},this.set=function(n){t=JSON.parse(JSON.stringify(n)),e.$broadcast("projects:updated",t)},this.update=function(n,o){t[n]=o,e.$broadcast("projects:updated",t)}}])}(),function(){"use strict";angular.module("app").service("signinCallbacks",["credentials","helperDialog","helperHTTP","projects","$rootScope",function(e,t,n,o,i){var r={};this.success=function(s){for(var a in s)"object"==typeof s[a]&&s[a].hasOwnProperty("access_token")&&(r.token=s[a].access_token);var c=function(e){var n=gapi.auth2.getAuthInstance();n.disconnect(),t.alert("Sign-in failed",e.data.message)},l=function(t){e.set(t.data.user),i.$broadcast("signin:updated",{text:"Signed in"}),o.set(t.data.projects)};n.set("login",r,l,c)},this.failure=function(t){e.set({})}}])}(),function(){"use strict";angular.module("app").service("signoutUnload",["helperHTTP","$window",function(e,t){t.onbeforeunload=function(){e.set("logout",{},function(){},function(){});var t=gapi.auth2.getAuthInstance();t.disconnect().then(function(){})}}]).run(["signoutUnload",function(e){}])}(),function(){"use strict";angular.module("app").directive("googleSignin",["signinCallbacks",function(e){var t=/\.apps\.googleusercontent\.com$/;return{restrict:"A",link:function(n,o,i){i.clientid+=t.test(i.clientid)?"":".apps.googleusercontent.com";var r={access_type:"offline",clientid:i.clientid,cookiepolicy:"single_host_origin",customtargetid:"google-signin",onfailure:e.failure,onsuccess:e.success,scope:"email"},s=document.getElementsByTagName("link")[0],a=document.createElement("link");a.type="text/css",a.async=!0,a.rel="stylesheet",a.href="https://fonts.googleapis.com/css?family=Roboto",s.parentNode.insertBefore(a,s);var c=document.getElementsByTagName("script")[0],l=document.createElement("script");l.type="text/javascript",l.async=!0,l.src="https://apis.google.com/js/client:platform.js",c.parentNode.insertBefore(l,c),l.onload=function(){gapi.load("auth2",function(){var e=gapi.auth2.init({client_id:r.clientid,cookie_policy:r.cookiepolicy});e.attachClickHandler(r.customtargetid,{},r.onsuccess,r.onfailure)})}}}}])}(),function(){"use strict";angular.module("app").directive("googleSignout",["credentials","$rootScope","$state",function(e,t,n){return{restrict:"A",link:function(n,o,i){o.bind("click",function(n){n.stopPropagation();var o=gapi.auth2.getAuthInstance();o.disconnect().then(function(){e.set({}),t.$broadcast("signin:updated",{text:"Sign in"})})})}}}])}(),function(){"use strict";angular.module("app").controller("signin",["__env","$scope","$state","$timeout",function(e,t,n,o){var i=this;i.clientID=e.clientID,i.signedIn=!1,i.signedInText="Sign in",t.$on("credentials:updated",function(e,r){r.name?(i.signedIn=!0,i.user=r.name,o(function(){t.$digest(),n.go("root.profile")})):(i.signedIn=!1,o(function(){t.$digest()}))}),t.$on("signin:updated",function(e,n){n.text&&(i.signedInText=n.text,o(function(){t.$digest()}))})}])}(),function(){"use strict";angular.module("app").controller("profile",["$scope","$timeout",function(e,t){var n=this;n.checkLocation=function(e,t){return!e||/^main-*/.test(e)?t:!t},n.introduction=!0,n.newProject=function(){n.introduction=!1,n.location="main-project-new",angular.element(document.getElementById("projects-button")).triggerHandler("click")},n.projects=[],n.selectProject=function(e){n.project&&n.project===e||(n.experiment="",n.project=e,n.sample="",n.screen=""),n.introduction=!1,n.location="main-project",angular.element(document.getElementById("projects-button")).triggerHandler("click")},e.$on("credentials:updated",function(o,i){i.name&&(n.user=i.name,t(function(){e.$digest()}))}),e.$on("projects:updated",function(o,i){n.projects=i,console.log(n.projects),t(function(){e.$digest()})})}])}(),function(){"use strict";angular.module("app").controller("projectNew",["credentials","helperHTTP","projects","$scope","$timeout",function(e,t,n,o,i){var r=this;r.form={},r.partialReset=function(){o.form.name="",o.form.description="",o.form.$setPristine(),o.form.$setUntouched(),r.form={}},r.reset=function(){o.form.name="",o.form.description="",o.form.$setPristine(),o.form.$setUntouched(),r.form={},r.message=""},r.submit=function(o,s){if(r.message="",o){var a=e.get(),c={};c.created=Date.now(),c.creator=a.name,c.description=s.description,c.title=s.name;var l=function(e){r.reset(),r.message=e.data.message,n.add(e.data.project),i(function(){r.message=""},1e4)},u=function(e){r.message=e.data.message,i(function(){r.message=""},1e4)};t.set("project",c,l,u)}}}])}(),function(){"use strict";angular.module("app").controller("projectManagement",["helperHTTP","helperObject","projects","$scope","$timeout",function(e,t,n,o,i){var r=this;r.addUsers=function(t,o,s){var a=[];o&&(a=o);for(var c=0,l=r.searchResults.length;c<l;c++)s[c]&&a.push({name:r.searchResults[c].name,lab:r.searchResults[c].lab});var u=function(e){n.update("users",a),r.addUsersMessage=e.data.message,i(function(){r.addUsersMessage=""},1e4)},p=function(e){r.addUsersMessage=e.data.message,i(function(){r.addUsersMessage=""},1e4)};e.set("project/users",{project:t,users:a},u,p)},r.searchUser={},r.newUsers=[],r.reset=function(){o.form.email="",o.form.$setPristine(),o.form.$setUntouched(),r.searchUser={}},r.submit=function(n,o){if(n&&t.notEmpty(o)){r.message="";var s=o,a=function(e){r.reset(),e.data.users.length>0?r.searchResults=e.data.users:(r.message="No users matched your search.",i(function(){r.message=""},1e4))},c=function(e){r.message=e.data.message,i(function(){r.message=""},1e4)};e.get("project/users",s,a,c)}},o.$on("projects:updated",function(e,t){console.log("here"),i(function(){o.$digest()})})}])}();